
<!DOCTYPE html>
<html lang="en" data-figures="" class="page">
  <head>
<title>Migrate Your MySQL Database to Google Cloud SQL over SSL/TLS Encrypted Connections With Minimal Downtime | Hervé Kakiang&#39;s blog</title>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.80.0" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150847968-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-150847968-1');
</script>
  
<meta property="og:locale" content="en" />

<meta property="og:type" content="article">
<meta name="description" content="With Google Cloud SQL, it&#39;s relatively easy to move your database between an external, self-managed server and the cloud with minimal downtime. With the …">
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="Migrate Your MySQL Database to Google Cloud SQL over SSL/TLS Encrypted Connections With Minimal Downtime" />
<meta property="og:url" content="https://hrv2k.github.io/post/migrate-your-mysql-database-to-google-cloud-sql-over-ssl-tls-encrypted-connection-with-minimal-downtime/" />
<meta property="og:title" content="Migrate Your MySQL Database to Google Cloud SQL over SSL/TLS Encrypted Connections With Minimal Downtime" />
<meta property="og:description" content="With Google Cloud SQL, it&#39;s relatively easy to move your database between an external, self-managed server and the cloud with minimal downtime. With the …" />
<meta property="og:image" content="https://hrv2k.github.io/images/migrate_cloudsql/cloudsql_migrate_replication1.png" />
<link rel="apple-touch-icon" sizes="180x180" href='https://hrv2k.github.io/icons/apple-touch-icon.png'>
<link rel="icon" type="image/png" href='https://hrv2k.github.io/icons/favicon.ico'>
<link rel="manifest" href='https://hrv2k.github.io/icons/site.webmanifest'>
<link rel="mask-icon" href='https://hrv2k.github.io/safari-pinned-tab.svg' color="#002538">
<meta name="msapplication-TileColor" content="#002538">
<meta name="theme-color" content="#002538">

<link rel="canonical" href="https://hrv2k.github.io/post/migrate-your-mysql-database-to-google-cloud-sql-over-ssl-tls-encrypted-connection-with-minimal-downtime/">

    

    
    
    <link rel="preload" href="https://hrv2k.github.io/css/styles.2c7a039ca654e98a4bbcdc27affbbd5d2c4756ba1937c909596644883e6c740f86855853713082a9b45ce91a88c6cf2b4cbacb1754b8bf9cb7c279d69e3c4d0f.css" integrity = "sha512-LHoDnKZU6YpLvNwnr/u9XSxHVroZN8kJWWZEiD5sdA&#43;GhVhTcTCCqbRc6RqIxs8rTLrLF1S4v5y3wnnWnjxNDw==" as="style" crossorigin="anonymous">
    <link rel="preload" href="https://hrv2k.github.io/js/bundle.min.cee36fbca464500550f3fdcee62b033060ebedabbfffa7f2961d06529ac3ffcf3c8d107e04af65ae030ed0918354da56a88baeabce9d950f354680c9fb346dde.js" as="script" integrity=
    "sha512-zuNvvKRkUAVQ8/3O5isDMGDr7au//6fylh0GUprD/888jRB&#43;BK9lrgMO0JGDVNpWqIuuq86dlQ81RoDJ&#43;zRt3g==" crossorigin="anonymous">

    
    <link rel="stylesheet" type="text/css" href="https://hrv2k.github.io/css/styles.2c7a039ca654e98a4bbcdc27affbbd5d2c4756ba1937c909596644883e6c740f86855853713082a9b45ce91a88c6cf2b4cbacb1754b8bf9cb7c279d69e3c4d0f.css" integrity="sha512-LHoDnKZU6YpLvNwnr/u9XSxHVroZN8kJWWZEiD5sdA&#43;GhVhTcTCCqbRc6RqIxs8rTLrLF1S4v5y3wnnWnjxNDw==" crossorigin="anonymous">
    
  </head>
  
  
    
  
  <body data-code="7" data-lines="false" id="documentTop">

<header class="nav_header" >
  <nav class="nav">
    <a href='https://hrv2k.github.io/' class="nav_brand nav_item">
      <img src="https://hrv2k.github.io/logos/logo.png" class="logo">
      <div class="nav_close">
        <div>
          <svg class="icon">
  <use xlink:href="#open-menu"></use>
</svg>
          <svg class="icon">
  <use xlink:href="#closeme"></use>
</svg>
        </div>
      </div>
    </a>
    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://hrv2k.github.io/" class="nav_item">Home </a>
  </div>
      
      <div class="nav_parent">
        <a href="#" class="nav_item"></a>
        <div class="nav_sub">
          <span class="nav_child"></span>
          
          <a href="https://hrv2k.github.io/" class="nav_child nav_item">English</a>
          
          <a href="https://hrv2k.github.io/fr/" class="nav_child nav_item">French</a>
          
        </div>
      </div>
      
<div class='follow'>
  <a href="https://github.com/herve2k">
    <svg class="icon">
  <use xlink:href="#github"></use>
</svg>
  </a>
  <a href="https://twitter.com/#">
    <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
  </a>
  <a href="https://www.linkedin.com/in/kakiang">
    <svg class="icon">
  <use xlink:href="#linkedin"></use>
</svg>
  </a>
    
  <a href="https://hrv2k.github.io/index.xml">
    <svg class="icon">
  <use xlink:href="#rss"></use>
</svg>
  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">Migrate Your MySQL Database to Google Cloud SQL over SSL/TLS Encrypted Connections With Minimal Downtime</h1><div class="post_meta">
  
    <svg class="icon">
  <use xlink:href="#calendar"></use>
</svg>
    <span class="post_date">
      Feb 17, 2020</span>
      <a href='https://hrv2k.github.io/tags/cloud-computing' class="post_tag button button_translucent">Cloud Computing
      </a>
      <a href='https://hrv2k.github.io/tags/gcp' class="post_tag button button_translucent">GCP
      </a>
      <a href='https://hrv2k.github.io/tags/cloud-sql' class="post_tag button button_translucent">Cloud SQL
      </a>
      <a href='https://hrv2k.github.io/tags/database-migration' class="post_tag button button_translucent">Database migration
      </a>
      <a href='https://hrv2k.github.io/tags/mysql' class="post_tag button button_translucent">MySQL
      </a>
</div>

    
  <div class="post_share">
    Share on:
    <a href="https://twitter.com/intent/tweet?text=Migrate%20Your%20MySQL%20Database%20to%20Google%20Cloud%20SQL%20over%20SSL%2fTLS%20Encrypted%20Connections%20With%20Minimal%20Downtime&url=https%3a%2f%2fhrv2k.github.io%2fpost%2fmigrate-your-mysql-database-to-google-cloud-sql-over-ssl-tls-encrypted-connection-with-minimal-downtime%2f&tw_p=tweetbutton" class="twitter" title="Share on Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fhrv2k.github.io%2fpost%2fmigrate-your-mysql-database-to-google-cloud-sql-over-ssl-tls-encrypted-connection-with-minimal-downtime%2f&t=Migrate%20Your%20MySQL%20Database%20to%20Google%20Cloud%20SQL%20over%20SSL%2fTLS%20Encrypted%20Connections%20With%20Minimal%20Downtime" class="facebook" title="Share on Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#facebook"></use>
</svg>
    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="Share on LinkedIn" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#linkedin"></use>
</svg>
    </a>
    <a href="https://hrv2k.github.io/post/migrate-your-mysql-database-to-google-cloud-sql-over-ssl-tls-encrypted-connection-with-minimal-downtime/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <use xlink:href="#copy"></use>
</svg>
    </a>
  </div>

    
    
    <h2>Overview</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#gcp-setup">GCP Setup</a></li>
    <li><a href="#create-a-vm-instance-to-simulate-your-external-mysql-server">Create a VM instance to simulate your external MySQL server</a></li>
    <li><a href="#deploy-a-mysql-database-on-the-vm-instance">Deploy a MySQL database on the VM instance</a></li>
    <li><a href="#create-and-populate-a-sample-database-for-demo-purposes">Create and populate a sample database for demo purposes</a></li>
    <li><a href="#prepare-your-mysql-database-server-for-migration">Prepare your MySQL database server for migration</a>
      <ul>
        <li><a href="#1-running-mysql-community-edition-version-56-or-57">1. Running MySQL Community Edition, version 5.6 or 5.7</a></li>
        <li><a href="#2-binary-logs-enabled">2. Binary logs enabled</a></li>
        <li><a href="#3-using-row-based-binary-logging">3. Using row-based binary logging.</a></li>
        <li><a href="#4-gtid-enabled-and-gtid-consistency-enforced">4. GTID enabled, and GTID consistency enforced.</a></li>
        <li><a href="#5-all-tables-except-tables-in-system-databases-use-the-innodb-storage-engine">5. All tables (except tables in system databases) use the InnoDB storage engine.</a></li>
        <li><a href="#6-mysql-user-account-with-the-replication_slave-privilege">6. MySQL user account with the REPLICATION_SLAVE privilege.</a></li>
        <li><a href="#7-an-externally-accessible-ipv4-address-and-tcp-port">7. An externally accessible IPv4 address and TCP port.</a></li>
        <li><a href="#8-ssltls-configuration-optional-but-recommended">8. SSL/TLS configuration (optional but recommended)</a></li>
      </ul>
    </li>
    <li><a href="#replication-configuration-process">Replication configuration process</a>
      <ul>
        <li><a href="#1-create-a-cloud-storage-bucket">1. Create a Cloud Storage bucket</a></li>
        <li><a href="#2-use-mysqldump-to-export-data-from-the-database">2. Use mysqldump to export data from the database</a></li>
        <li><a href="#3-copy-the-dump-file-to-cloud-storage">3. Copy the dump file to Cloud Storage</a></li>
        <li><a href="#4-create-the-cloud-sql-replica-using-the-automated-migration-workflow">4. Create the Cloud SQL replica using the automated migration workflow</a></li>
        <li><a href="#5-set-the-replicas-root-user-password">5. Set the replica's root user password</a></li>
        <li><a href="#6-confirm-replication-status">6. Confirm replication status</a></li>
        <li><a href="#7-promoting-the-replica-to-a-stand-alone-instance">7. Promoting the replica to a stand-alone instance</a></li>
      </ul>
    </li>
  </ul>
</nav>
    <p>The following is a step-by-step walkthrough of how to migrate a MySQL
database to Google Cloud SQL.</p>
<p><a href="https://cloud.google.com/sql">Google Cloud SQL</a> is a Database as a
Service (DBaaS) that enables you to create, configure, and manage
relational databases on the Google Cloud Platform (GCP). This service
manages and maintains your databases, thereby letting you focus on your
applications and services.</p>
<p>With Google Cloud SQL, it's relatively easy to move your database between
an external, self-managed server and the cloud with minimal downtime. With
the capability to easily move data in and out of Cloud SQL, you can quickly
leverage your existing database on Google Cloud. So in this post, you are
going to migrate an external MySQL database to Google Cloud SQL.</p>
<p>MySQL has two features that can serve as the basis for
<a href="https://cloud.google.com/solutions/migrating-mysql-to-cloudsql-concept/">migration strategies</a>:</p>
<ol>
<li>
<p>The MySQL <code>mysqldump</code> command enables <a href="https://cloud.google.com/solutions/migrating-mysql-to-cloudsql-concept/#exportimport_migration">export/import migration</a>.</p>
</li>
<li>
<p>MySQL Replication enables <a href="https://cloud.google.com/solutions/migrating-mysql-to-cloudsql-concept/#external_replica_promotion_migration">External replica promotion migration</a>.</p>
</li>
</ol>
<p>The export/import migration involves the following high-level steps:</p>
<ul>
<li>Stop the external database instance.</li>
<li>Export all of the data in the external database by using the MySQL <code>mysqldump</code> command.</li>
<li>Import the data directly to a Cloud SQL database instance.</li>
</ul>
<p>The export/import migration strategy consists of a simple process but it
requires database downtime for the entire migration process, which can
take a while depending on the size of your database.</p>
<p>On the other hand, the external replica promotion migration strategy involves the
<a href="https://cloud.google.com/sql/docs/mysql/migrate-data#migrating-to-sql">following steps</a>:</p>
<ul>
<li>Configuring your external database server to meet <a href="https://cloud.google.com/sql/docs/mysql/replication/replication-from-external#server-requirements">the requirements for Cloud SQL replication</a></li>
<li>Creating a Cloud SQL replica for your external database server.</li>
<li>Taking your applications offline and updating them to point to the replica after the data is synchronized.</li>
<li>Promoting the replica to a stand-alone instance</li>
<li>Restarting your applications</li>
</ul>
<p>Many of the steps of this migration can be performed using the Cloud SQL
automated migration workflow, which causes minimal database downtime
compared to the export/import migration.</p>
<p>When performing a migration, you want to lower the risk of migration
failure and minimize database downtime related to the database migration.
The external replica promotion migration with the automated migration
workflow appears to be the migration strategy that can help you reach
these objectives.
Let's do precisely that in this post. We will provision a VM instance on
Google Compute Engine (GCE) and deploy a MySQL database on it to simulate
the external server.</p>
<h2 id="gcp-setup">GCP Setup</h2>
<p>You need to complete the following steps before you begin</p>
<ol>
<li>
<p>As it is always the case, before you create/manage resources on the GCP,
you need to <a href="https://console.cloud.google.com/projectselector2/home/dashboard">select or create</a>
a Google Cloud project.</p>
</li>
<li>
<p>Then <a href="https://cloud.google.com/billing/docs/how-to/modify-project">enable billing</a>
for the Cloud project because the components you are going to use, Cloud SQL
and Compute Engine, are billable components.</p>
</li>
<li>
<p><a href="https://console.cloud.google.com/flows/enableapi?apiid=compute.googleapis.com,sql-component.googleapis.com">Enable the Compute Engine and Cloud SQL APIs</a></p>
</li>
<li>
<p>Install and authenticate the <a href="https://cloud.google.com/sdk/downloads">gcloud command-line tool</a>,
or use <a href="https://console.cloud.google.com/?cloudshell=true">Cloud Shell</a>
to create and control your GCP resources.</p>
</li>
</ol>
<h2 id="create-a-vm-instance-to-simulate-your-external-mysql-server">Create a VM instance to simulate your external MySQL server</h2>
<p>200 rows in the <code>actor</code> table in the <code>sakila</code> database on the external MySQL</p>
<ol>
<li>
<p>Create a VM instance:
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>gcloud compute instances create external-mysql-server <span class="se">\
</span><span class="ln">2</span><span class="se"></span>       --zone<span class="o">=</span>us-central1-a --preemptible --tags<span class="o">=</span>mysql-server <span class="se">\
</span><span class="ln">3</span><span class="se"></span>       --scopes storage-rw,service-control,service-management,<span class="se">\
</span><span class="ln">4</span><span class="se"></span>       logging-write,monitoring-write,trace</code></pre></div></p>
</li>
<li>
<p>Create a firewall rule to allow external traffic to the MySQL server:
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>gcloud compute firewall-rules create mysql-firewall <span class="se">\
</span><span class="ln">2</span><span class="se"></span>     --allow tcp:3306 <span class="se">\
</span><span class="ln">3</span><span class="se"></span>     --target-tags mysql-server</code></pre></div></p>
</li>
</ol>
<h2 id="deploy-a-mysql-database-on-the-vm-instance">Deploy a MySQL database on the VM instance</h2>
<p>In the Cloud Console, <a href="https://console.cloud.google.com/compute/instances">go to the VM Instances page</a>,
then click on the SSH  button in the row of the instance that you just
created. A window opens and gives you command-line access to your VM.
<img src="/images/migrate_cloudsql/ssh_button.png" alt="Connect to the VM using SSH">
Once you have had access to the VM instance, use the
<a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/">MySQL APT Repository to install MySQL</a>.</p>
<p>First, download <a href="https://dev.mysql.com/downloads/repo/apt/">the release package</a>
for your distribution:
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>wget https://dev.mysql.com/get/mysql-apt-config_0.8.14-1_all.deb</code></pre></div></p>
<p>Then, install the downloaded release package:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo dpkg -i mysql-apt-config_0.8.14-1_all.deb</code></pre></div>
<p>During the installation of the package, you are asked to choose the
version of the MySQL server you want to install. Select <code>mysql-5.7</code>.</p>
<p><img src="/images/migrate_cloudsql/mysql_version.png" alt="Choose the MySQL version"></p>
<p>Select <strong>Ok</strong> to finish the configuration and installation of the release package.</p>
<p><img src="/images/migrate_cloudsql/mysql_version_ok.png" alt="Choose Ok to finish"></p>
<p>Update the list of packages:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo apt update</code></pre></div>
<p>Install MySQL:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo apt install mysql-server</code></pre></div>
<p>During the installation, you are asked to provide a password for the
MySQL root user:</p>
<p><img src="/images/migrate_cloudsql/mysql_pass.png" alt="Set password for Mysql root user"></p>
<p>Once the installation completes successfully, the MySQL server starts
automatically. You can check its status using the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo service mysql status</code></pre></div>
<p>The output looks similar to this:
<img src="/images/migrate_cloudsql/mysql_status.png" alt="MySQL server status"></p>
<h2 id="create-and-populate-a-sample-database-for-demo-purposes">Create and populate a sample database for demo purposes</h2>
<p>If you have a database ready to follow along with, you can skip this
section. Otherwise, you can use <a href="https://dev.mysql.com/doc/sakila/en/">the Sakila sample database</a>.
The Sakila sample database is representative of real-world databases,
that's because it highlights features of MySQL such as Views, Stored
Procedures and Triggers, and even spatial-aware location column for
MySQL 5.7.5 and higher.</p>
<p>In the VM instance terminal, download the Sakila database:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>wget https://downloads.mysql.com/docs/sakila-db.tar.gz</code></pre></div>
<p>Unzip it.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>tar -zxvf sakila-db.tar.gz</code></pre></div>
<p>The output looks something similar to this...
<img src="/images/migrate_cloudsql/untarsakila.png" alt="untar sakila"></p>
<p>The <code>sakila-schema.sql</code> file contains all the statements required to
create the database structure. The <code>sakila-data.sql</code> file contains the
INSERT statements. The <code>sakila.mwb</code> file is a MySQL Workbench data model.</p>
<p>Connect to the MySQL server using the mysql command-line client, enter
your password when prompted:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>mysql -u root -p</code></pre></div>
<p>Then execute the <code>sakila-schema.sql</code> script to create the database structure:</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="n">SOURCE</span> <span class="err">$</span><span class="n">HOME</span><span class="o">/</span><span class="n">sakila</span><span class="o">-</span><span class="n">db</span><span class="o">/</span><span class="n">sakila</span><span class="o">-</span><span class="k">schema</span><span class="p">.</span><span class="k">sql</span><span class="p">;</span></code></pre></div>
<p>And execute the <code>sakila-data.sql</code> script to populate the database.</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="n">SOURCE</span> <span class="err">$</span><span class="n">HOME</span><span class="o">/</span><span class="n">sakila</span><span class="o">-</span><span class="n">db</span><span class="o">/</span><span class="n">sakila</span><span class="o">-</span><span class="n">data</span><span class="p">.</span><span class="k">sql</span><span class="p">;</span></code></pre></div>
<p>Confirm that the database has been created and populated correctly by
executing the following statements:</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">USE</span> <span class="n">sakila</span><span class="p">;</span></code></pre></div>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">SHOW</span> <span class="n">FULL</span> <span class="kp">TABLES</span><span class="p">;</span></code></pre></div>
<p>The output looks like this:
<img src="/images/migrate_cloudsql/show_sakila1.png" alt="show sakila"></p>
<p>Run the following query to count the rows in the <code>actor</code> table:
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">SELECT</span> <span class="nf">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">actor</span><span class="p">;</span></code></pre></div></p>
<p>The output looks like this:
<img src="/images/migrate_cloudsql/exec_select_external.png" alt="Query sakila actor table">
200 rows in the <code>actor</code> table in the <code>sakila</code> database on the external MySQL
server. Take note of this result, you'll later compare it to the number
of rows in the <code>actor</code> table in the replicated database.</p>
<h2 id="prepare-your-mysql-database-server-for-migration">Prepare your MySQL database server for migration</h2>
<p>There are <a href="https://cloud.google.com/sql/docs/mysql/replication/replication-from-external#server-requirements">configuration prerequisites</a>
that your external MySQL database server must meet before you can use the
automated migration workflow to migrate to Cloud SQL.</p>
<p>Let's check these Cloud SQL migration prerequisites one by one:</p>
<p>First of all, you have to set the <code>server_id</code>. The <code>server_id</code> must be
specified on each server, i.e. the master server and each slave server.
It has to be in the range from 1 to 2^32 − 1 and must be unique.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo <span class="nb">echo</span> <span class="s2">&#34;server-id = 2&#34;</span> &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre></div>
<h3 id="1-running-mysql-community-edition-version-56-or-57">1. Running MySQL Community Edition, version 5.6 or 5.7</h3>
<p>Confirm that you've installed the required version, which is MySQL
Community Edition version 5.6 or 5.7, by logging in to MySQL
server.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>mysql -u root -p</code></pre></div>
<p>Then enter the MySQL root user password that you set during the installation.
<img src="/images/migrate_cloudsql/mysql_version_check.png" alt="MySQL server version"></p>
<h3 id="2-binary-logs-enabled">2. Binary logs enabled</h3>
<p>With MySQL replication, one or more MySQL database servers (the slaves)
copy data from a MySQL database server (the master).
For replication to work, events regarding how the database has changed
have to be recorded in the master's binary log, then the slaves read and
processed them.</p>
<p>In the MySQL configuration file <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>, enable
<a href="https://dev.mysql.com/doc/refman/5.7/en/replication-options-binary-log.html">binary logging</a>
and set the filename the database will use
to store the logs in to <code>mysql-bin</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo <span class="nb">echo</span> <span class="s2">&#34;log-bin = mysql-bin&#34;</span> &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre></div>
<h3 id="3-using-row-based-binary-logging">3. Using row-based binary logging.</h3>
<p>Replication can be done using statement-based binary logging or row-based
logging or both. In MySQL 5.7.7 and later, row-based format is the default.
If you are using an earlier version, run the following command to
set the binary logging format to <code>ROW</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo <span class="nb">echo</span> <span class="s2">&#34;binlog-format = ROW&#34;</span> &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre></div>
<h3 id="4-gtid-enabled-and-gtid-consistency-enforced">4. GTID enabled, and GTID consistency enforced.</h3>
<p>A <a href="http://dev.mysql.com/doc/refman/5.7/en/replication-gtids-concepts.html">global transaction identifier</a>
(GTID) is a unique identifier created and associated with each database
change (DDL or DML) that is written to the binary log. With GTID enables,
the replication is completely transaction-based, making it simple to
synchronize masters and slaves, since it comes done whether or not all
transactions committed on a master are also committed on a slave. However
<a href="https://dev.mysql.com/doc/refman/5.7/en/replication-options-gtids.html#sysvar_enforce_gtid_consistency">when GTID is enabled, operations that violate GTID consistency are not allowed</a>.
MySQL <a href="https://dev.mysql.com/doc/refman/5.7/en/replication-gtids-restrictions.html">restricts</a>
those operations to ensure a consistent replication process.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo -s
<span class="ln">2</span><span class="nb">echo</span> <span class="s2">&#34;gtid_mode = ON&#34;</span> &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf
<span class="ln">3</span><span class="nb">echo</span> <span class="s2">&#34;enforce-gtid-consistency = TRUE&#34;</span> &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf
<span class="ln">4</span>exit</code></pre></div>
<h3 id="5-all-tables-except-tables-in-system-databases-use-the-innodb-storage-engine">5. All tables (except tables in system databases) use the InnoDB storage engine.</h3>
<p>Connect to your MySQL database as the root user on the Compute Engine VM
and run this command to make sure that all the tables in your database
are using <code>InnoDB</code> storage engine; enter the MySQL root password when
prompted:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>mysql -u root -p sakila <span class="se">\
</span><span class="ln">2</span><span class="se"></span>     -e <span class="s2">&#34;SHOW TABLE STATUS WHERE Engine != &#39;InnoDB&#39; \G&#34;</span></code></pre></div>
<p>If this command returns an empty result, you are good to go, all your
tables are using the <code>InnoDB</code> storage engine. But if the command returns
a list of tables, those are probably using <code>MyISAM</code> storage engine. You
have to <a href="https://dev.mysql.com/doc/refman/5.7/en/converting-tables-to-innodb.html#innodb-convert-convert">convert them to InnoDB</a>.</p>
<h3 id="6-mysql-user-account-with-the-replication_slave-privilege">6. MySQL user account with the REPLICATION_SLAVE privilege.</h3>
<p>There must be a user account on the your external MySQL server (master)
that the Cloud SQL replica instance (slave) can use to connect. The account has
to be granted the <code>REPLICATION SLAVE</code> privilege.
Connect to your MySQL database as the root user, enter the MySQL root
password when you prompted:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>mysql -u root -p</code></pre></div>
<p>Then create the MySQL replication user:</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span> <span class="k">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;replpassword&#39;</span><span class="p">;</span></code></pre></div>
<p>And grant it <code>REPLICATION SLAVE</code> privilege.
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">GRANT</span> <span class="n">REPLICATION</span> <span class="n">SLAVE</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span></code></pre></div></p>
<p>This replication user can connect from any host, you will
restrict the connections to only Cloud SQL read replica
<strong>outgoing IP address</strong> in a later step.</p>
<p>You have to configure the external MySQL server to allow external
connections. This is done by changing the <code>bind-address</code> entry in the
MySQL configuration file.</p>
<p>In the external MySQL server, run the following command in the terminal:
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo sed -i <span class="s1">&#39;s/bind-address.*/bind-address = 0.0.0.0/&#39;</span> /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre></div></p>
<p>At this point, you need to restart your MySQL server for the new
configurations to take effect:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo service mysql restart</code></pre></div>
<h3 id="7-an-externally-accessible-ipv4-address-and-tcp-port">7. An externally accessible IPv4 address and TCP port.</h3>
<p><a href="https://console.cloud.google.com/compute/instances">Go to the VM Instances page</a>
and note the external IP address of your MySQL server.
<img src="/images/migrate_cloudsql/mysql_server_ip.png" alt="MySQL server ip"></p>
<h3 id="8-ssltls-configuration-optional-but-recommended">8. SSL/TLS configuration (optional but recommended)</h3>
<p>You can use <a href="https://dev.mysql.com/doc/refman/5.7/en/creating-ssl-rsa-files-using-mysql.html">mysql_ssl_rsa_setup</a>
to create the SSL certificate and key files to support secure connections
between the external MySQL server and the Cloud SQL read replica.
<code>mysql_ssl_rsa_setup</code> uses <code>openssl</code>, so you need to
have it installed on your server before you can use <code>mysql_ssl_rsa_setup</code>.
Run the following command to generate the SSL files:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo mysql_ssl_rsa_setup --verbose</code></pre></div>
<p>If the SSL files have already been generated by MySQL and are present in
the data directory for SSL files ( <code>/var/lib/mysql</code>), <code>mysql_ssl_rsa_setup</code>
creates nothing. Otherwise, it creates the files.
<img src="/images/migrate_cloudsql/ssl_generation.png" alt="Generate ssl files">
You will use these files to enable Cloud SQL to use SSL/TLS encryption
for the replication connection.</p>
<h2 id="replication-configuration-process">Replication configuration process</h2>
<p>Having your external MySQL server met the requirements for replication
to Cloud SQL, you can now move on to the replication process. You will
perform the following steps in this process:</p>
<ul>
<li>Create a Cloud Storage bucket.</li>
<li>Use <code>mysqldump</code> to backup of the external database.</li>
<li>Copy the dump file to the Cloud Storage bucket.</li>
<li>Create Cloud SQL read replica of your external MySQL server,
<ul>
<li>Configure Cloud SQL read replica to use SSL/TLS encryption.</li>
<li>Import the dump file into the Cloud SQL read replica,</li>
<li>Restrict the MySQL replication user to accept connections only from
the replica's <strong>outgoing IP address</strong> (for security reasons).</li>
</ul>
</li>
<li>Set the replica's root user password.</li>
<li>Confirm replication status.</li>
<li>Promote the replica to primary.</li>
</ul>
<h3 id="1-create-a-cloud-storage-bucket">1. Create a Cloud Storage bucket</h3>
<p>Using Cloud Shell, create a Cloud Storage bucket to store your MySQL
database backup:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>gsutil mb gs://cloud-engineer-project-mysql/</code></pre></div>
<p>Note that Cloud Storage bucket names have to be globally unique. Using
project IDs is an easy way to have a unique name. However exposing
project IDs can pose security problems.</p>
<h3 id="2-use-mysqldump-to-export-data-from-the-database">2. Use mysqldump to export data from the database</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo mysqldump <span class="se">\
</span><span class="ln">2</span><span class="se"></span>    -h localhost -P <span class="m">3306</span> -u root -p <span class="se">\
</span><span class="ln">3</span><span class="se"></span>    --databases sakila --order-by-primary <span class="se">\
</span><span class="ln">4</span><span class="se"></span>    --hex-blob --master-data<span class="o">=</span><span class="m">1</span> --no-autocommit <span class="se">\
</span><span class="ln">5</span><span class="se"></span>    --skip-triggers --skip-add-drop-table <span class="se">\
</span><span class="ln">6</span><span class="se"></span>    --skip-add-locks --skip-disable-keys --skip-set-charset <span class="se">\
</span><span class="ln">7</span><span class="se"></span>    --default-character-set<span class="o">=</span>utf8 --single-transaction <span class="se">\
</span><span class="ln">8</span><span class="se"></span>    --set-gtid-purged<span class="o">=</span>on <span class="p">|</span> gzip &gt; sakila_backup1.sql.gz</code></pre></div>
<p>There are many things going on with this <code>mysqldump</code> command. Check out the
<a href="https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html">documentation</a>
for more details. Essentially,</p>
<ul>
<li>
<p><code>--master-data=1</code> option makes <code>mysqldump</code> writes the binary log file
name and position to the dump file. The Cloud SQL replica (slave) will
use that information to determine where to start replicating from the
master after the dump file has been imported. The external MySQL server
can continue accepting write operations.</p>
</li>
<li>
<p>The <code>--opt</code> option is enabled by default. According to the
<a href="https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html#option_mysqldump_opt">documentation</a>,
&quot;it gives a fast dump operation and produces a dump file that can be
reloaded into a MySQL server quickly&quot;.</p>
</li>
</ul>
<h3 id="3-copy-the-dump-file-to-cloud-storage">3. Copy the dump file to Cloud Storage</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo gsutil cp sakila_backup1.sql.gz gs://cloud-engineer-project-mysql</code></pre></div>
<h3 id="4-create-the-cloud-sql-replica-using-the-automated-migration-workflow">4. Create the Cloud SQL replica using the automated migration workflow</h3>
<p><a href="https://console.cloud.google.com/sql/instances">Go the Cloud SQL page</a>
and click on <strong>MIGRATE DATA</strong>:
<img src="/images/migrate_cloudsql/cloudsql_migrate.png" alt="Cloud SQL migrate"></p>
<p>Then click on <strong>Begin migration</strong>.
<img src="/images/migrate_cloudsql/cloudsql_begin_migration.png" alt="Cloud SQL begin migrate"></p>
<p>Fill out the data source details.</p>
<ul>
<li>Name of data source: <strong>sakila-datasource</strong></li>
<li>The <strong>Public IP address of source</strong> is the external IP
address of your MySQL server.</li>
<li>Make sure to <strong>enable SSL/TLS security</strong>.</li>
</ul>
<p><img src="/images/migrate_cloudsql/cloudsql_migration1.png" alt="Cloud SQL migration 1"></p>
<p>You have to upload or copy the PEM-encoded CA certificate of your
external MySQL database server. We went with the old copy and paste.
Use <code>sudo cat</code> command to display the <code>ca.pem</code> file from <code>/var/lib/mysql</code>,
copy the output and paste it in the certificate value box as shown below.
That's the only file required for the server-only authentication.
However if you want to have the strongest security, you should use
server-client authentication; check <strong>Use SSL client authentication</strong> box
for that.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migration1_ca.png" alt="Cloud SQL migration 1"></p>
<p>You have to provide the client certificate and the private key. From
<code>/var/lib/mysql</code> directory, use <code>sudo cat</code> command to display the content
of the <code>client-cert.pem</code> and <code>client-key.pem</code> files. Copy the contents of
those and paste them in their respective boxes as shown below. Then click
<strong>Next</strong> to continue.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migration1_client-cert.png" alt="Cloud SQL migration 1">
<img src="/images/migrate_cloudsql/next.png" alt="Cloud SQL migration next"></p>
<p>For better performance, it's recommended to create the replica close to
the data source. In other words create the replica in the same region/zone
as the external MySQL server.
It's also recommended to choose a <code>machine-type</code> that has
at least the same specs as your external server.
<img src="/images/migrate_cloudsql/cloudsql_migration2.png" alt="Cloud SQL migration 2"></p>
<p>Still in the <strong>Cloud SQL read replica creation</strong> section, make sure
<strong>Enable automatic storage increases</strong> is checked.</p>
<p>Click on <strong>Browse</strong> to import the dump file that you created and copied
to Cloud Storage bucket earlier.</p>
<p>Then click on <strong>Show advanced settings</strong>.
<img src="/images/migrate_cloudsql/cloudsql_migration3.png" alt="Cloud SQL migration 3"></p>
<p>Allow your external MySQL server to access the Cloud SQL replica.
Click on <strong>+ Add network</strong>, enter <code>external-mysql-network</code> for the <strong>Name</strong>
and enter the external IP address of your MySQL server for the <strong>Network</strong>.
In this case, it's the external IP address of the VM you deployed MySQL on.
Then click <strong>Done</strong>.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migration4.png" alt="Cloud SQL migration 4"></p>
<p>Click <strong>Create</strong> to start the creation of your Cloud SQL replica instance.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migration5.png" alt="Cloud SQL migration 5"></p>
<p>Take note of the <strong>Outgoing IP address</strong>.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migration6.png" alt="Cloud SQL migration 6"></p>
<p>The MySQL replication user you created earlier accepts connections from
any host. For security reasons, you should restrict the connections to
only the Cloud SQL replica's <strong>outgoing IP address</strong>.</p>
<p><div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">UPDATE</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span> <span class="kt">SET</span> <span class="n">Host</span><span class="o">=</span><span class="s1">&#39;35.225.210.234&#39;</span> <span class="k">WHERE</span> <span class="n">Host</span><span class="o">=</span><span class="s1">&#39;%&#39;</span> <span class="k">AND</span> <span class="k">User</span><span class="o">=</span><span class="s1">&#39;repl&#39;</span><span class="p">;</span></code></pre></div>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span></code></pre></div></p>
<p>Change <code>35.225.210.234</code> in the command above for the <strong>outgoing IP address</strong>
that is actually provisioned for your Cloud SQL read replica instance.</p>
<p>Go back to <strong>Data Synchronization</strong> section in the migration workflow,
Click <strong>Next</strong> to continue. Then you'll see the page below; click <strong>Finish</strong>
to complete the migration workflow.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migration7.png" alt="Cloud SQL migration 7"></p>
<p>Depending on the size of your database, the network throughput, the IOPS,
the import can take up to a couple of minutes or hours. When the green check
mark appears next to the Cloud SQL read replica (<strong>MySQL read replica</strong>)
like below, the import has completed and the replication is enabled.
Click on the instance to go to the replica instance overview page:</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migrate_import_complete.png" alt="Cloud SQL migration import_complete"></p>
<h3 id="5-set-the-replicas-root-user-password">5. Set the replica's root user password</h3>
<p>In the replica instance overview, you'll see details about the instance
and the replication status.
Click on <strong>Users</strong> in the left menu to set the root password for the
replica instance.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migrate_replication1.png" alt="Cloud SQL migration import_complete"></p>
<p>Click on the 3 vertical dots, then on <strong>Change password</strong>. Input a password
and click <strong>OK</strong> to complete the operation.</p>
<p><img src="/images/migrate_cloudsql/cloudsql_migrate_changepass.png" alt="Cloud SQL migration import_complete"></p>
<p>You can also use <a href="https://console.cloud.google.com/?cloudshell=true">Cloud Shell</a>
to change the password:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>gcloud sql users set-password root --host<span class="o">=</span>% <span class="se">\
</span><span class="ln">2</span><span class="se"></span>    --instance<span class="o">=</span>sakila-datasource-cloudsql <span class="se">\
</span><span class="ln">3</span><span class="se"></span>    --password<span class="o">=</span>root-password-here</code></pre></div>
<p>To mininmize downtime, re-create all the critical database user accounts
for your applications. You just have to click on <strong>Create user account</strong>
and set the username and password of the account.</p>
<h3 id="6-confirm-replication-status">6. Confirm replication status</h3>
<p>You are now going to connect to the replica instance to query the database
and see the replication in action. In the replica instance overview page,
scroll down to the <strong>Connnect to this instance</strong> card and click on
<strong>Connect using Cloud Shell</strong>.</p>
<p><img src="/images/migrate_cloudsql/connect_replica_instance.png" alt="Connect to replica instance"></p>
<p>Cloud Shell opens up, if it wasn't already; and the <code>gcloud sql connect</code>
command with the replica name is input in the terminal. Press <strong>ENTER</strong>
to execute the command.
When prompted for password, enter the root user password of the replica
instance you just set above.
<img src="/images/migrate_cloudsql/connecting_replica_instance.png" alt="Connecting to replica instance"></p>
<p>Execute the same statements you executed on the external MySQL database
server, you'll get the same results.</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">USE</span> <span class="n">sakila</span><span class="p">;</span></code></pre></div>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">SHOW</span> <span class="n">FULL</span> <span class="kp">TABLES</span><span class="p">;</span></code></pre></div>
<p>To verify that the replication is activated, first run the following query
to count the rows in the <code>actor</code> table.</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">SELECT</span> <span class="nf">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">actor</span><span class="p">;</span></code></pre></div>
<p>The output looks like this.</p>
<p><img src="/images/migrate_cloudsql/exec_select_cloudsql.png" alt="Query cloud sql actor table"></p>
<p>200 rows in the <code>actor</code> table in the <code>sakila</code> database on the replica
instance. It matches that of the external MySQL:</p>
<p>Now go back to the external MySQL server terminal, connect to MySQL
server and insert a row into the <code>actor</code> table by executing the query below:</p>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="nf">actor</span> <span class="p">(</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;Denzel&#39;</span><span class="p">,</span> <span class="s1">&#39;Washington&#39;</span><span class="p">);</span></code></pre></div>
<p>Count the number rows: It's now 201 as shown below.
<img src="/images/migrate_cloudsql/verify_replication.png" alt="Verify replication"></p>
<p>Now check that the new inserted data has been replicated. Go back to
Cloud Shell, connect to your replica instance and run the queries below
against the <code>actor</code> table in the replica.</p>
<p><div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">SELECT</span> <span class="nf">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">actor</span><span class="p">;</span></code></pre></div>
<div class="highlight"><pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="ln">1</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">actor</span> <span class="k">WHERE</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Washington&#39;</span><span class="p">;</span></code></pre></div></p>
<p>The output looks like this:
<img src="/images/migrate_cloudsql/replication_verified.png" alt="Replication verified">
This confirms that the replication is enabled and properly working.</p>
<h3 id="7-promoting-the-replica-to-a-stand-alone-instance">7. Promoting the replica to a stand-alone instance</h3>
<p>For all this time, your applications are online. They are not affected
by all the replication setup you have done. But now is the downtime time.
You have to take your applications offline and update them to point to
Cloud SQL read replica, promote the replica, then bring your apps back on
line.
To connect your apps to Cloud SQL instances, it's recommended to use
<a href="https://cloud.google.com/sql/docs/mysql/sql-proxy">Cloud SQL Proxy</a> unless
your apps are in the same region as your Cloud SQL instance, and on the
VPC network in the GCP or on a VPN configured to connect to the the Cloud
SQL instance network through a private connection. When you use Cloud SQL Proxy,
<a href="https://cloud.google.com/sql/docs/mysql/sql-proxy#what_the_proxy_provides">you get a secured connection to your Cloud SQL instance without
management overhead</a>.
And because of <a href="https://cloud.google.com/sql/docs/mysql/sql-proxy#how-works">the way Cloud SQL Proxy works</a>,
you access your Cloud SQL instance as if it was running in the local environment.</p>
<h4 id="71-so-download-cloud-sql-proxy-to-your-applications-server-and-make-it-executable">7.1. So download Cloud SQL Proxy to your applications server and make it executable:</h4>
<p><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>wget https://dl.google.com/cloudsql/cloud_sql_proxy.linux.amd64 -O cloud_sql_proxy</code></pre></div>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>chmod +x cloud_sql_proxy</code></pre></div></p>
<h4 id="72-create-a-service-account-for-cloud-sql-proxy">7.2. Create a service account for Cloud SQL Proxy</h4>
<p>You need to create a service account with a Cloud SQL Client role to provide
the credentials for the proxy.
Use Cloud Shell to enable the Cloud SQL Admin API.
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>gcloud services <span class="nb">enable</span> sqladmin.googleapis.com</code></pre></div></p>
<p>Next, <a href="https://console.cloud.google.com/iam-admin/serviceaccounts/">Go to the Service accounts page</a>,
Click <strong>Create service account</strong>.</p>
<p><img src="/images/migrate_cloudsql/create_sa_click.png" alt="create a service account"></p>
<p>Provide a name and description for the service account. Then click on <strong>CREATE</strong>
<img src="/images/migrate_cloudsql/create_sa.png" alt="create a service account"></p>
<p>For Role, you can select either one of these: Cloud SQL Client, Cloud SQL Editor,
Cloud SQL Admin:</p>
<p><img src="/images/migrate_cloudsql/create_sa_role.png" alt="create a service account select role"></p>
<p>Click on <strong>CONTINUE</strong> to create a private key.</p>
<p><img src="/images/migrate_cloudsql/create_sa_role1.png" alt="create a service account select role"></p>
<p>Then click on <strong>CREATE KEY</strong> to choose the key type format <strong>JSON</strong></p>
<p><img src="/images/migrate_cloudsql/create_sa_create_key.png" alt="create a service account select role"></p>
<p>And finally download the key by clicking on <strong>CREATE</strong>.</p>
<p><img src="/images/migrate_cloudsql/create_sa_download_key.png" alt="create a service account select role"></p>
<p>The private key file is downloaded to your machine. Move it to the applications
server, where the Cloud SQL proxy will run.</p>
<p><img src="/images/migrate_cloudsql/create_sa_downloaded.png" alt="create a service account select role"></p>
<h4 id="73-take-your-applications-offline">7.3. Take your applications offline.</h4>
<p>Update them with the Cloud SQL credentials.
Note that if you have re-created the database user accounts on the Cloud SQL
replica database, at this point you wouldn't have to change udpate anything
on your applications.
Besides taking your apps offline, stop the external MySQL instance:
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo service mysql stop</code></pre></div></p>
<h4 id="74-promote-the-replica">7.4. Promote the replica</h4>
<p>In the replica instance overview page, Click on <strong>PROMOTE REPLICA</strong>, then
on <strong>OK</strong> to start the promotion.
<img src="/images/migrate_cloudsql/promote_replica.png" alt="Replication verified">
It will take a few minutes. When it's done you will see the replica instance
becoming a stand-alone instance:
<img src="/images/migrate_cloudsql/promotion_complete.png" alt="Replication verified"></p>
<h4 id="74-start-the-cloud-sql-proxy-and-restart-your-applications">7.4. Start the Cloud SQL proxy and restart your applications</h4>
<p>In the replica instance overview page,
scroll down to the <strong>Connnect to this instance</strong> card and note the
<strong>instance connection name</strong>.</p>
<p>Start the proxy
<div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell"><span class="ln">1</span>./cloud_sql_proxy -instances<span class="o">=</span>&lt;INSTANCE_CONNECTION_NAME&gt;<span class="o">=</span>tcp:3306 <span class="se">\
</span><span class="ln">2</span><span class="se"></span>                  -credential_file<span class="o">=</span>&lt;PATH_TO_KEY_FILE&gt; <span class="p">&amp;</span></code></pre></div></p>
<p>Restart your apps.</p>
<p>Thanks for reading!</p>
<p>To learn more about Google Cloud SQL, visit <a href="http://cloud.google.com/sql">http://cloud.google.com/sql</a></p>
<hr>

    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hervekakiangblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
    
      <h2>Hervé Kakiang</h2>
      <div>
        Technologist, perpetual student, continual incremental improvement.
      </div>
      <a href='https://hrv2k.github.io/about/' class="button mt-1" role="button">Read More</a>
    <h2 class="mt-4">Recent Posts</h2>
    <ul class="flex-column">
      <li>
        <a href="https://hrv2k.github.io/post/ibm-cloud-free-tier/" class="nav-link">IBM Cloud Offerings with no expiration and no credit card required</a>
      </li>
      <li>
        <a href="https://hrv2k.github.io/post/create-a-nosql-database-using-mysql-document-store/" class="nav-link">Create a NoSQL Database Using MySQL Document Store</a>
      </li>
      <li>
        <a href="https://hrv2k.github.io/post/deploy-a-flask-mysql-app-to-gce-using-deployment-manager/" class="nav-link">Deploy a Flask &#43; MySQL App to GCE Using Deployment Manager</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">Categories</h2>
      <nav class="tags_nav">
        <a href='https://hrv2k.github.io/categories/cloud/' class="post_tag button button_translucent">
          CLOUD
          <span class="button_tally">1</span>
        </a>
        
        
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">Tags</h2>
      <nav class="tags_nav">
        <a href='https://hrv2k.github.io/tags/gcp/' class="post_tag button button_translucent">
          GCP
          <span class="button_tally">10</span>
        </a>
        
        <a href='https://hrv2k.github.io/tags/cloud-computing/' class="post_tag button button_translucent">
          CLOUD-COMPUTING
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://hrv2k.github.io/tags/cloud-build/' class="post_tag button button_translucent">
          CLOUD-BUILD
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://hrv2k.github.io/tags/cloud-run/' class="post_tag button button_translucent">
          CLOUD-RUN
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://hrv2k.github.io/tags/cloud-functions/' class="post_tag button button_translucent">
          CLOUD-FUNCTIONS
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://hrv2k.github.io/tags/cloud-scheduler/' class="post_tag button button_translucent">
          CLOUD-SCHEDULER
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://hrv2k.github.io/tags/build-triggers/' class="post_tag button button_translucent">
          BUILD-TRIGGERS
          <span class="button_tally">1</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">All Tags</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://hrv2k.github.io/tags/build-triggers/' class=" post_tag button button_translucent" data-position=1>BUILD-TRIGGERS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/ci/cd/' class=" post_tag button button_translucent" data-position=1>CI/CD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud/' class=" post_tag button button_translucent" data-position=1>CLOUD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-bigtable/' class=" post_tag button button_translucent" data-position=1>CLOUD-BIGTABLE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-build/' class=" post_tag button button_translucent" data-position=3>CLOUD-BUILD<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-computing/' class=" post_tag button button_translucent" data-position=9>CLOUD-COMPUTING<span class="button_tally">9</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-functions/' class=" post_tag button button_translucent" data-position=2>CLOUD-FUNCTIONS<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-kms/' class=" post_tag button button_translucent" data-position=1>CLOUD-KMS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-run/' class=" post_tag button button_translucent" data-position=3>CLOUD-RUN<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-scheduler/' class=" post_tag button button_translucent" data-position=2>CLOUD-SCHEDULER<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-spanner/' class=" post_tag button button_translucent" data-position=1>CLOUD-SPANNER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/cloud-sql/' class=" post_tag button button_translucent" data-position=1>CLOUD-SQL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/computing/' class=" post_tag button button_translucent" data-position=1>COMPUTING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/custom-domain/' class=" post_tag button button_translucent" data-position=1>CUSTOM-DOMAIN<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/database-migration/' class=" post_tag button button_translucent" data-position=1>DATABASE-MIGRATION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/deployment-manager/' class=" post_tag button button_translucent" data-position=1>DEPLOYMENT-MANAGER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/encryption/' class=" post_tag button button_translucent" data-position=1>ENCRYPTION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/gcp/' class=" post_tag button button_translucent" data-position=10>GCP<span class="button_tally">10</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/github/' class=" post_tag button button_translucent" data-position=1>GITHUB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/iac/' class=" post_tag button button_translucent" data-position=1>IAC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/ibm-cloud/' class=" post_tag button button_translucent" data-position=1>IBM-CLOUD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/manage-instance-groups/' class=" post_tag button button_translucent" data-position=1>MANAGE-INSTANCE-GROUPS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://hrv2k.github.io/tags/mysql/' class=" post_tag button button_translucent" data-position=1>MYSQL<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
  </section>
</aside>

</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/> 
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="arrow">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
</svg>

<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://hrv2k.github.io/images/logo.png' class="icon icon_2 transparent">
    <p>Copyright 2020-<span class="year"></span> HERVÉ KAKIANG&#39;S BLOG. All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <use xlink:href="#arrow"></use>
</svg>
</a>

  </div>
</footer>

    <script type="text/javascript" src="https://hrv2k.github.io/js/bundle.min.cee36fbca464500550f3fdcee62b033060ebedabbfffa7f2961d06529ac3ffcf3c8d107e04af65ae030ed0918354da56a88baeabce9d950f354680c9fb346dde.js" integrity="sha512-zuNvvKRkUAVQ8/3O5isDMGDr7au//6fylh0GUprD/888jRB&#43;BK9lrgMO0JGDVNpWqIuuq86dlQ81RoDJ&#43;zRt3g==" crossorigin="anonymous"></script>
    
  </body>
</html>
